<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ROUTEGUESSR - LEGENDARY LINES</title>
    <link href="{{ url_for('static', filename='styles/legendary_lines_base.css')}}" rel="stylesheet"/>
    <link href="{{ url_for('static', filename='styles/legendary_lines_level.css')}}" rel="stylesheet"/>
</head>
<body>
    <div class="gradient-layer"></div>
    <div class="particle-container" id="particleContainer"></div>
    <div class="background-layer"></div>
    <a class="gradient-title anton-regular" href="/">ROUTEGUESSR</a>
    <div class="container">
        <div class="archivo-regular page-title">LEGENDARY LINES</div>
        <div class="description-container">
            <div class="chat-header">
                <span class="chat-title-name bebas-neue-regular">Route Description</span>
            </div>
            <div class="description-body">
                <div class="description-message">
                    <div class="message-content pt-sans"></div>                   
                </div>
            </div>
        </div>
        <div class="selection-container">
            <div class="area-list">
                <div class="list-item active"></div>
            </div>
            <div class="list-preview">

            </div>
        </div>
    </div>
    <script>
        const areaId = "{{ area_id }}";
        const source = new EventSource(`/legendary-lines/stream/${areaId}`);
        const container = document.querySelector('.message-content');
        container.textContent = '';

        let charQueue = [];
        let typing = false;
        let charDelay = 0.5; // ms per character â€” adjust this to control speed

        function typeNextChar() {
            if (charQueue.length === 0) {
                typing = false;
                return;
            }
            container.textContent += charQueue.shift();
            setTimeout(typeNextChar, charDelay);
        }

        function enqueueText(text) {
            for (const ch of text) {
                charQueue.push(ch);
            }
            if (!typing) {
                typing = true;
                typeNextChar();
            }
        }

        source.onmessage = (event) => {
            if (event.data === '[DONE]') {
                source.close();
                return;
            }
            enqueueText(event.data);
        };
    </script>
</body>
</html>